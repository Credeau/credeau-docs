# AccountGator API

The AccountGator API provides programmatic access to our intelligent transaction analysis engine, delivering actionable insights and financial intelligence from bank account transactions for enhanced credit decisioning, fraud detection, and customer financial profiling.

## Base URL

```bash
https://gator.credeau.com
```

## Variables

The following variables will be referenced throughout this documentation:

| Variable      | Description                                | Format                                     | Source                                |
|---------------|--------------------------------------------|--------------------------------------------|---------------------------------------|
| `client_id`   | Unique identifier for your organization    | Alphanumeric string                        | Provided by Credeau during onboarding |
| `auth_token`  | Secret token for API authentication        | Alphanumeric string                        | Provided by Credeau during onboarding |
| `user_id`     | Unique identifier for an end user          | Alphanumeric string, max 64 chars, non-PII | Generated by your application         |


> ⚠️ **Note**
>
> Keep these credentials secure and never share them publicly. These credentials are unique to your organization and will be used to authenticate all API requests.

## Endpoints

### AccountGator API

```bash
POST /api/account_gator_api
```

## Authentication

The API requires two authentication headers:

| Header | Value |
|--------|-------|
| `x-client-id` | `<client_id>` |
| `x-auth-token` | `<auth_token>` |

and, one content type header:

| Header | Value |
|--------|-------|
| `Content-Type` | `application/json` |

## Request Parameters

### Request Body (JSON)

| Parameter                                | Type                         | Required | Description |
|------------------------------------------|------------------------------|----------|-------------|
| `user_id`                                | string                       | Yes      | Unique identifier for the end user (e.g., "test-user-1") |
| `client_id`                              | string                       | Yes      | Your organization's unique client identifier |
| `raw_data`                               | map[string]object            | Yes      | Container object for account metadata and transaction data |
| `raw_data.metadata`                      | map[string]string            | Yes      | Account and statement metadata information |
| `raw_data.metadata.currency`             | string                       | Yes      | Currency code for the account (e.g., "INR") |
| `raw_data.metadata.bank_name`            | string                       | Yes      | Name of the bank (e.g., "ICICI BANK") |
| `raw_data.metadata.ifsc_code`            | string                       | Yes      | Indian Financial System Code for the bank branch (e.g., "ICIC0004106") |
| `raw_data.metadata.account_type`         | string                       | Yes      | Type of bank account (e.g., "Savings", "Current") |
| `raw_data.metadata.employer_name`        | string                       | Yes      | Name of the account holder's employer (can be empty string) |
| `raw_data.metadata.account_number`       | string                       | Yes      | Bank account number (can be empty string for privacy) |
| `raw_data.metadata.account_holder_name`  | string                       | Yes      | Name of the account holder (can be empty string for privacy) |
| `raw_data.metadata.statement_fetch_date` | string                       | Yes      | Date and time when the statement was fetched (format: "YYYY-MM-DD HH:MM:SS.mmm") |
| `raw_data.metadata.statement_start_date` | string                       | Yes      | Start date of the statement period (format: "YYYY-MM-DD") |
| `raw_data.metadata.statement_end_date`   | string                       | Yes      | End date of the statement period (format: "YYYY-MM-DD") |
| `raw_data.transaction_data`              | array[`<transaction_entry>`] | Yes      | Array of transaction entries from the bank statement |
| `cutoff_date`                            | string                       | Yes      | Analysis cutoff date and time (format: "YYYY-MM-DD HH:MM:SS") |
| `format_type`                            | string                       | Yes      | Format of the input data (e.g., "generic_json") |
| `fetch_extraction_report`                | bool                         | Yes      | Whether to include detailed extraction report in the response |

`<transaction_entry>`

| Parameter              | Type   | Required | Description |
|------------------------|--------|----------|-------------|
| `txnId`                | string | Yes      | Unique transaction identifier (e.g., "00000001") |
| `type`                 | string | Yes      | Transaction type: "DEBIT" or "CREDIT" |
| `amount`               | float  | Yes      | Transaction amount in the account currency |
| `currentBalance`       | string | Yes      | Account balance after this transaction |
| `transactionTimestamp` | string | Yes      | Date and time of the transaction (ISO 8601 format: "YYYY-MM-DDTHH:MM:SS.mmm+00:00") |
| `narration`            | string | Yes      | Transaction description/narration from the bank statement |

### Request cURL

```bash
curl --location 'https://gator.credeau.com/api/account_gator_api' \
--header 'x-client-id: <client_id>' \
--header 'x-auth-token: <auth_token>' \
--header 'Content-Type: application/json' \
--data-raw '{
    "user_id": "test-user-1",
    "client_id": "<client_id>",
    "raw_data": {
        "metadata": {
            "currency": "INR",
            "bank_name": "ICICI BANK",
            "ifsc_code": "ICIC0004106",
            "account_type": "Savings",
            "employer_name": "",
            "account_number": "",
            "account_holder_name": "",
            "statement_fetch_date": "2024-12-12 15:15:05.561",
            "statement_start_date": "2024-09-01",
            "statement_end_date": "2024-12-12"
        },
        "transaction_data": [
            {
                "txnId": "00000001",
                "type": "DEBIT",
                "amount": 3000,
                "currentBalance": "555.96",
                "transactionTimestamp": "2024-09-01T00:00:00.000+00:00",
                "narration": "UPI/kjvadshakj@okax/UPI/Federal Bank/424568888143/SBI7b7d76759af8494790ee09a0e35cf155"
            },
            {
                "txnId": "00000771",
                "type": "DEBIT",
                "amount": 98,
                "currentBalance": "29146.81",
                "transactionTimestamp": "2024-12-12T00:06:00.000+00:00",
                "narration": "BIL/IMB/000941773667/PayeeName/Fee/397301508 379"
            },
            {
                "txnId": "00000772",
                "type": "DEBIT",
                "amount": 9000,
                "currentBalance": "20146.81",
                "transactionTimestamp": "2024-12-12T00:08:00.000+00:00",
                "narration": "MMT/IMPS/434705724233/590546858/UTIB0001351"
            }
        ]
    },
    "cutoff_date": "2024-12-12 23:59:59",
    "format_type": "generic_json",
    "fetch_extraction_report": false
}'
```

## Response

### Response Fields (JSON)

| Field Name         | Type   | Description |
|--------------------|--------|-------------|
| `name_match_flag`  | bool   | Boolean indicator whether the names match based on the configured threshold |
| `name_match_score` | float  | Numerical match score ranging from 0-100, indicating the degree of similarity |
| `name_match_algo`  | string | Identifier of the matching algorithm used for audit and transparency |
| `fuzz_score`       | float  | Fuzzy matching score (0-100) using fuzzy logic algorithms for additional validation |
| `first_name`       | string | Extracted first name component from the input names (null if not detected) |
| `last_name`        | string | Extracted last name component from the input names |
| `gender`           | string | Detected gender based on name analysis (e.g., "Male", "Female", "Unknown") |
| `gender_prob`      | float  | Confidence probability (0-1) for the gender detection result |

### Success Responses

#### HTTP 200 OK (Success)

When the name matching successfully completes.

```json
{
    "name_match_flag": true,
    "name_match_score": 83.33333333333333,
    "name_match_algo": "1-5",
    "fuzz_score": 100.0,
    "first_name": "sanyam",
    "last_name": "jain",
    "gender": "Male",
    "gender_prob": 1.0
}
```

### Error Responses

#### HTTP 401 Unauthorized (Wrong credentials)

This error occurs when either an invalid client ID or authentication token is provided in the request headers.

> ⚠️ **Note**
>
> If you receive this error:
>
> 1. Verify that you're using the correct client ID and authentication token
> 2. Contact Credeau support

---

#### HTTP 403 Forbidden (Invalid Access)

This error can occur when the requesting IP address is not whitelisted in the Credeau firewall. For security reasons, all API requests must originate from pre-approved IP addresses.

```html
<html>
    <head><title>403 Forbidden</title></head>
    <body>
        <center><h1>403 Forbidden</h1></center>
    </body>
</html>
```

> ⚠️ **Note**
>
> To resolve this error:
>
> 1. Contact Credeau support to whitelist your IP address
> 2. Provide your organization's name and the IP address(es) that need access
> 3. Once whitelisted, you'll be able to access the API from the approved IP addresses

---

#### HTTP 422 Unprocessable Content (Wrong Request Payload)

This error is returned when any of the required parameters is missing from the request payload. The response includes details about which fields are missing and the received input.

```json
{
    "detail": [
        {
            "type": "missing",
            "loc": [
                "body",
                "user_id"
            ],
            "msg": "Field required",
            "input": {
                "source_name": "...",
                "target_name": "..."
            }
        }
    ]
}
```

---

#### HTTP 429 Too Many Requests (Rate Limit Exceeded)

This error is returned when the rate of requests exceeds the allowed limit of 1000 requests per minute per IP.

**Best Practice for Rate Limit Handling**

When implementing retries for rate-limited requests:

1. Use exponential backoff: Start with a base delay (e.g., 1 second) and double it after each retry
2. Add jitter: Include random variation (±20%) to the delay to prevent thundering herd problems

Example implementation:

```python
import random
import time
def get_retry_delay(attempt, base_delay=1, max_delay=60):
    # Calculate exponential backoff
    delay = min(base_delay * (2 ** attempt), max_delay)
    # Add jitter (±20%)
    jitter = delay * 0.2
    return delay + random.uniform(-jitter, jitter)
```

This approach helps distribute retry attempts and prevents overwhelming the API when rate limits are hit.
